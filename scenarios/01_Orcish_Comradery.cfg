#textdomain wesnoth-AD

[scenario]
    id=AD_01
    name= _ "Orcish Comradery"
    map_data="{~add-ons/Ashievieres_Dogs/maps/AD_01.map}"

    [event]
    name=new_turn 
    first_time_only=no

        {LIGHT_EFFECT "*^Ecf"}
    [/event] 

    {RIVER_SLOW 32 25 4 10}
    {RIVER_SLOW 34 20 4 10}
    {RIVER_SLOW 36 10 4 10}

    {TURNS 30 28 26}
    next_scenario=AD_02
    victory_when_enemies_defeated=yes
    carryover_percentage=40
    carryover_add=yes
    current_time=2

    {DEFAULT_SCHEDULE}

    {SCENARIO_MUSIC "knolls.ogg"}
    {EXTRA_SCENARIO_MUSIC "northerners.ogg"}
    {EXTRA_SCENARIO_MUSIC "battle.ogg"}

    [story]
        [part]
            story=_"501 YW. Prince Eldred treacherously murdered Garard II and became King of Wesnoth, but his reign came to an abrupt end at the hands of Delfador at the Battle of Tath. Only the king's minor nephews, his three-year-old daughter Li'sar, and Queen Consort Asheviere remained alive from the royal family."
            background=story/httt_story6.jpg
        [/part]
        [part]
            story=_"The status of Queen consort deprived Asheviere of her rights to the throne. She would have been satisfied with the role of Regent to young Li'sar, but there was a catch: according to the old tradition, women had no inheritance rights, which meant that one of Garard's nephews would be king. Each of them was supported by noble lords who would undoubtedly take advantage of the situation and push Asheviere and her daughter into the background."
            {AD_BIGMAP}
        [/part]
        [part]
            story=_"Asheviere didn't want to live in someone else's shadow. She saw herself as the rightful Queen of Wesnoth, and her daughter as the heiress. So she started to act."
            {AD_BIGMAP}
        [/part]
        [part]
            story=_"After killing all of the minor nephews, Asheviere used her regent status and made a law equalizing men and women in the right of inheritance. Technically, this did not remove her status as Consort Queen, and the throne should have passed to Li'Sar. However, Asheviere declared that she would rule as Queen until the princess became an adult."
            {AD_BIGMAP}
        [/part]
        [part]
            story=_"Some of the noble lords, mostly from Eldred's army, swore allegiance to the new Queen. The other part, from the veterans of Garard, openly opposed it. They decided that if Wesnoth needed a new king, he should be chosen among them, the most worthy lords, not among the powerless, deceitful remnants of the royal family."
            {AD_BIGMAP}
        [/part]
        [part]
            story=_"Divided into two camps, the country was sliding into the abyss of civil war."
            {AD_BIGMAP}
        [/part]
        [part]
            story=_"Asheviere controlled the capital, Weldyn, but rebels occupied the center of the country, including the cities of Dan-Tonk, Tath, and Soradoc. The Queen was surrounded by enemies."
            {AD_BIGMAP}
        [/part]
        [part]
            story=_"To secure herself from the east, Asheviere reaffirmed the privileges of the Great Plains clans and even extended them by freeing noble sons from mandatory military service. This improved her position, but it did not add strength to her army."
            {AD_BIGMAP}
        [/part]
        [part]
            story=_"At the same time, the rebels had a strong army of Garard veterans, and only internal disputes about the future ruler kept them from the march on Weldyn."
            {AD_BIGMAP}
        [/part]
        [part]
            story=_"Asheviere's fate hung in the balance. She decided to break the encirclement from the north, bringing in the help of previously unimaginable allies..."
            {AD_BIGMAP}
        [/part]
        [part]
            background=story/act1_logo.png
        [/part]
    [/story]

    {AD_TRACK {JOURNEY_01_NEW} }

    {STARTING_VILLAGES 1 4}
    {STARTING_VILLAGES 2 4}
    {STARTING_VILLAGES 3 4}

	[item]
		image="items/burial.png"
		submerge=1
		visible_in_fog=no
		x=7
		y=13
	[/item]
	[item]
		image="scenery/village-human-burned1.png"
		submerge=1
		visible_in_fog=no
		x=12
		y=20
	[/item]
	[item]
		image="scenery/whitefang-flag.png"
		submerge=1
		visible_in_fog=no
		x=13
		y=15
	[/item]
	[item]
		image="scenery/whitefang-flag.png"
		submerge=1
		visible_in_fog=no
		x=15
		y=18
	[/item]
	[item]
		image="scenery/village-human-burned3.png"
		submerge=1
		visible_in_fog=no
		x=17
		y=25
	[/item]
	[item]
		image="items/burial.png"
		submerge=1
		visible_in_fog=no
		x=18
		y=22
	[/item]
	[item]
		image="items/burial.png"
		submerge=1
		visible_in_fog=no
		x=27
		y=9
	[/item]

    [label]
        x,y=35,21
        text=_ "River Listra"
        immutable=yes
    [/label]

    #player average recruit cost = 17,6

    [side]
        side=1
        controller=human
        gold=125
        {INCOME 5 3 1}
        fog=no
        shroud=no
        share_vision=all
        {BAZUR_ARC_I}
        recruit=Orcish Grunt,Orcish Archer,Wolf Rider,Goblin Spearman,Troll Whelp,Orcish Assassin
        color=white 
        team_name=bazur
        user_team_name= _ "Bazur"
        {FLAG_VARIANT ragged}
    [/side]

    [side]
        side=2
        controller=ai
        {GOLD 50 100 150}
        income=0
        fog=no
        shroud=no
        share_vision=all
        type=Orcish Warrior
        id=Warlord_Troll
        name=_ "Hu'ug"
        profile="portraits/orcs/grunt-2.webp"
        [modifications]
            {TRAIT_STRONG}
        [/modifications]
        recruit=Orcish Grunt,Orcish Archer,Wolf Rider,Goblin Spearman,Troll Whelp
        color=blue
        team_name=bazur
        user_team_name= _ "Whitefang Orcs"
        {FLAG_VARIANT ragged}

        [ai]
        {NO_SCOUTS}
        grouping=no
        aggression={ON_DIFFICULTY "0.75" "0.85" "0.95"}
        recruitment_pattern=fighter,fighter,fighter,scout,archer

            [goal]
                [criteria]
                    side=1
                [/criteria]
                value=3
            [/goal]

            [goal]
                [criteria]
                    id=Bazur
                [/criteria]
                value={ON_DIFFICULTY "1.25" "2.25" "3.25"}
            [/goal]

            [aspect]
                id=recruitment_instructions
                [facet]
                    turns=1-2
                    [value] 
                        [recruit]
                            type=Troll Whelp
                            number=1
                        [/recruit]
                        [recruit]
                            importance=0
                        [/recruit]
                    [/value]
                [/facet]
            [/aspect]
        [/ai]

        [unit]
            type={ON_DIFFICULTY "Orcish Archer" "Orcish Archer" "Orcish Crossbowman"}
            name=_ "Orc Guard"
            x,y=13,16
            ai_special=guardian
            [modifications]
                #ifdef NORMAL
                    {TRAIT_RESILIENT}
                #endif
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
    [/side]

    [side]
        side=3
        controller=ai
        {GOLD 50 100 150}
        income=0
        fog=no
        shroud=no
        share_vision=all
        type=Orcish Warrior
        id=Warlord_Assassin
        name=_ "Ruksha"
        [modifications]
            {TRAIT_STRONG}
        [/modifications]
        profile="portraits/orcs/grunt-5.webp"
        recruit=Orcish Grunt,Orcish Archer,Wolf Rider,Goblin Spearman,Orcish Assassin
        color=green
        team_name=bazur
        user_team_name= _ "Whitefang Orcs"
        {FLAG_VARIANT ragged}

        [ai]
            {NO_SCOUTS}
            grouping=no
            aggression={ON_DIFFICULTY "0.75" "0.85" "0.95"}
            recruitment_pattern=archer,mixed fighter,scout,archer

            [goal]
                [criteria]
                    side=1
                [/criteria]
                value=3
            [/goal]

            [goal]
                [criteria]
                    id=Bazur
                [/criteria]
                value={ON_DIFFICULTY "1.25" "2.25" "3.25"}
            [/goal]

            [aspect]
                id=recruitment_instructions
                [facet]
                    turns=1-2
                    [value] 
                        [recruit]
                            type=Orcish Assassin
                            number=1
                        [/recruit]
                        [recruit]
                            importance=0
                        [/recruit]
                    [/value]
                [/facet]
            [/aspect]
        [/ai]

        [unit]
            type={ON_DIFFICULTY "Orcish Archer" "Orcish Archer" "Orcish Crossbowman"}
            name=_ "Orc Guard"
            x,y=14,17
            ai_special=guardian
            [modifications]
                #ifdef NORMAL
                    {TRAIT_RESILIENT}
                #endif
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
    [/side]

    [side]
        side=4
        controller=ai
        gold=0
        income=0
        fog=no
        shroud=no
        share_vision=all
        no_leader=yes
        recruit=
        color=purple
        team_name=loyalists
        user_team_name= _ "Asheviere's Forces"
        {FLAG_VARIANT loyalist}

        [ai]
            caution=0.99
            allow_ally_villages=yes
            [avoid]
                x,y=14,16
                radius=6
            [/avoid]
        [/ai]
    [/side]

    {AD_RECRUIT_EVENT}

    #hint for novice players 

    [event]
    name=recruit

        [filter]
            side=1
            type=Troll Whelp 
        [/filter]

        [object] 
            silent=no 
            name= _ "Troll Whelp"
            image="units/trolls/whelp.png~RC(magenta>white)"
            duration=scenario
            description= _ "Trolls are often allied with orcs, and the Whitefang clan is no exception. They can <i>regenerate</i>, restoring 8 hitpoints or cure poison every turn as if they were in a village."
            [filter]
                find_in=unit 
            [/filter]
        [/object]
    [/event]

    #defensive AI leader behavior if player pushes 

    [event]
    name=side 2 turn 
    id=Huug_caution
    first_time_only=no 

        [if]
            [have_unit]
                side=1
                count=3-100 
                [not]
                    level=0 
                [/not]
                [filter_location]
                    x,y,radius=6,4,5
                [/filter_location]
            [/have_unit]
        [then]
            {MODIFY_SIDE_AI (2) (grouping=defensive)}
            {ADD_LEADER_GOAL 2 huug_stays_at_keep 6 4 no 1}

            {MODIFY_AI_ADD_GOAL 2 (
            [goal]
                id=defend_huug
                name=protect_unit
                [criteria]
                    id=Warlord_Troll
                [/criteria]
                value=100
            [/goal]
            )}
        [/then]
        [else]
            {MODIFY_SIDE_AI (2) (grouping=no)}

            [modify_ai]
                side=2
                action=delete
                path=aspect[leader_goal].facet[huug_stays_at_keep]
            [/modify_ai]

            [modify_ai]
                side=2
                action=delete
                path=goal[defend_huug]
            [/modify_ai]
        [/else]
        [/if]
    [/event]

    [event]
    name=side 3 turn 
    id=Ruksha_caution
    first_time_only=no 

        [if]
            [have_unit]
                side=1
                count=3-100 
                [not]
                    level=0 
                [/not]
                [filter_location]
                    x,y,radius=30,21,5
                [/filter_location]
            [/have_unit]
        [then]
            {MODIFY_SIDE_AI (3) (grouping=defensive)}
            {ADD_LEADER_GOAL 3 ruksha_stays_at_keep 30 21 no 1}

            {MODIFY_AI_ADD_GOAL 3 (
            [goal]
                id=defend_ruksha
                name=protect_unit
                [criteria]
                    id=Warlord_Assassin
                [/criteria]
                value=100
            [/goal]
            )}
        [/then]
        [else]
            {MODIFY_SIDE_AI (3) (grouping=no)}

            [modify_ai]
                side=3
                action=delete
                path=aspect[leader_goal].facet[ruksha_stays_at_keep]
            [/modify_ai]

            [modify_ai]
                side=3
                action=delete
                path=goal[defend_ruksha]
            [/modify_ai]
        [/else]
        [/if]
    [/event]

    [event]
        name=prestart 

        [micro_ai]
            side=2
            ai_type=simple_attack
            action=add

            ca_score=110000
            [filter]
                side=2
            [/filter]
            [filter_second]
                id=Bazur 
            [/filter_second]
        [/micro_ai]

        [micro_ai]
            side=3
            ai_type=simple_attack
            action=add

            ca_score=110000
            [filter]
                side=3
            [/filter]
            [filter_second]
                id=Bazur 
            [/filter_second]
        [/micro_ai]
    [/event]

    [event]
    name=start

        [message]
            speaker=narrator
            image="wesnoth-icon.png"
            message=_ "In the second month of Asheviere's reign, a messenger from Wesnoth arrived in the orcish lands that lay north of the Great River..."
        [/message]

        [unit]
            {WESNOTH_MESSENGER}
            id=messenger
            side=4
            x,y=2,27
            max_moves=0
            [modifications]
                {TRAIT_LOYAL_HERO}
            [/modifications]
        [/unit]

        [sound]
            name=horse-canter.wav
        [/sound]

        {MOVE_UNIT id=messenger 5 25}

        {REPEAT 3 (
        [unit]
            type=Cavalryman
            side=4
            x,y=2,27
            random_traits=yes
        [/unit]

        {MOVE_UNIT x,y=2,27 5 25}
        )}

        [unit]
            type=Horseman
            side=4
            x,y=2,27
            random_traits=yes
        [/unit]

        {MOVE_UNIT x,y=2,27 5 25}

        [message]
            sound=horn-signals/horn-3.ogg
            speaker=messenger
            message=_ "Orcs of the north! Asheviere, Queen of Wesnoth, is gathering warriors to fight the rebels and invites You to join Her army as mercenaries. The Queen promises generous wages to those who answer Her call!"
        [/message]

        [message]
            speaker=Warlord_Troll
            message=_ "Bullshit, we've already taken tribute from your worthless Wesnoth. And if we want more human gold, we'll come and get it, so tell that to your Queen!"
        [/message]

        [message]
            speaker=Warlord_Assassin
            message=_ "Aha! Only a weakling would serve those who've been punched in the ass by orcs!"
        [/message]

        [message]
            speaker=Bazur
            message=_ "And I'll agree. I'll go, although I'm not a weakling."
        [/message]

        [message]
            speaker=Warlord_Troll
            message=_ "Eh! Why do you want to serve humans, Bazur?"
        [/message]

        [message]
            speaker=Bazur
            message=_ "I have fought no worse than you, but received the smallest part of the tribute. I deserve better, and I will prove it."
        [/message]

        [message]
            speaker=Warlord_Assassin
            message=_ "You jealous worm, the High Chief has divided the tribute based on merit. Don't dishonor the orcs, you're not going anywhere!"
        [/message]

        [message]
            speaker=Bazur
            message=_ "That's not for you freaks to decide."
        [/message]

        [message]
            speaker=messenger
            message=_ "At least one of the three. Well! Gather your warriors and march to the border."
        [/message]

        [modify_side]
            side=4
            team_name=bazur
        [/modify_side]

        [modify_side]
            side=2,3
            team_name=evil_orcs
        [/modify_side]

        [message]
            sound=ambient/wardrums.ogg
            speaker=Warlord_Troll
            message=_ "No way! Grunts, don't let the bastard get away!"
        [/message]

        [message]
            speaker=messenger
            message=_ "I can send my riders against one of the enemy chieftains to help You."
        [/message]

        [message]
            speaker=Bazur
            [option]
                    label=_ "Send them against Hu'ug! (blue chief)"
                    [command]
                        {MODIFY_AI_ADD_GOAL 4 (
                        [goal]
                            id=target
                            [criteria]
                                side=2
                            [/criteria]
                            value=10
                        [/goal]
                    )}
                    [/command]
            [/option]
            [option]
                    label=_ "Send them against Ruksha! (green chief)"
                    [command]
                        {MODIFY_AI_ADD_GOAL 4 (
                        [goal]
                            id=target
                            [criteria]
                                side=3
                            [/criteria]
                            value=10
                        [/goal]
                    )}
                    [/command]
            [/option]
        [/message]

        [message]
            speaker=messenger
            message=_ "It's a deal."
        [/message]

        [message]
            speaker=Bazur
            message=_ "I bet there are some of my neighbours' orcs who want to come with me. Perhaps I should slaughter the thirsty Hu'ug and Ruksha to gain more loyal backers."
        [/message]
        
        [objectives]
            silent=no
                [objective]
                    description= _ "Move Bazur to a hex adjacent to the messenger"
                    condition=win
                [/objective]
                [objective]
                    caption= _ "Alternative task:"
                    description= _ "Defeat the enemy leaders (early finish bonus)"
                    condition=win
                [/objective]
                [objective]
                    [show_if]
                        [have_unit]
                            id=Warlord_Troll
                        [/have_unit]
                    [/show_if]
                    description= _ "Killing Hu'ug will give you a loyal Orcish Grunt and a Troll Whelp"
                    condition=win
                [/objective]
                [objective]
                    [show_if]
                        [have_unit]
                            id=Warlord_Assassin
                        [/have_unit]
                    [/show_if]
                    description= _ "Killing Ruksha will give you a loyal Orcish Assassin and Archer"
                    condition=win
                [/objective]
                [objective]
                    description= _ "Death of Bazur"
                    condition=lose
                [/objective]
                [objective]
                    description= _ "Death of Wesnoth Messenger"
                    condition=lose
                [/objective]
                {TURNS_RUN_OUT}
                [gold_carryover]
                    bonus=no
                    carryover_percentage=40
                    carryover_add=yes
                [/gold_carryover]
        [/objectives]   
    [/event] 

    #победа - передвижение

    [event]
    name=moveto
    first_time_only=yes

        [filter]
            id=Bazur
            [filter_location]
                x,y=5,25
                radius=1
            [/filter_location]
        [/filter]

        [message]
            speaker=messenger
            message=_ "Well done. Be sure you'll earn far more in Asheviere's service than in any of your raids."
        [/message]

        [message]
            speaker=Bazur
            message=_ "Uh-huh. Enjoy your stay, losers!"
        [/message]

        [message]
            side=2
            [or]
                side=3
            [/or]
            message=_ "You bastard Bazur, I wish you were dead in the first fight!"
        [/message]

        [endlevel]
            result=victory
            carryover_add=yes 
            bonus=no
        [/endlevel]
    [/event]

    [event]
    name=last_breath

        [filter]
            id=Warlord_Troll
        [/filter]

        [message]
            speaker=Bazur
            message=_ "I knew you were weaker than me, you filth!"
        [/message]
        [message]
            speaker=unit
            message=_ "Who the hell do you think you are!"
        [/message]
    [/event]

    [event]
    name=die

        [filter]
            id=Warlord_Troll
        [/filter]

        [store_unit]
            [filter]
                id=Bazur 
            [/filter]
            kill=no
            variable=bazur 
        [/store_unit]

        [unit]
            type=Orcish Grunt 
            side=1
            id=Loyal_Grunt 
            name=_ "Moog"
            unrenamable=yes
            placement=leader
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_FEARLESS}
            [/modifications]
            animate=yes
        [/unit]

        [unit]
            type=Troll Whelp
            side=1
            id=Loyal_Whelp
            name=_ "Grump"
            unrenamable=yes
            placement=leader
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_INTELLIGENT}
            [/modifications]
            animate=yes
        [/unit]

        [message]
            speaker=Loyal_Whelp
            message=_ "Hu'ug was stupid. We want to go to Wesnoth with Bazur!"
        [/message]

    [/event]

    [event]
    name=last_breath

        [filter]
            id=Warlord_Assassin
        [/filter]

        [message]
            speaker=Bazur
            message=_ "Who's a weakling now?"
        [/message]
        [message]
            speaker=unit
            message=_ "You, because you sell yourself to the humans!"
        [/message]
    [/event]

    [event]
    name=die

        [filter]
            id=Warlord_Assassin
        [/filter]

        [store_unit]
            [filter]
                id=Bazur 
            [/filter]
            kill=no
            variable=bazur 
        [/store_unit]

        [unit]
            type=Orcish Assassin
            side=1
            id=Loyal_Assassin
            unrenamable=yes
            name= _ "Arshag"
            placement=leader
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_DEXTROUS}
            [/modifications]
            animate=yes
        [/unit]

        [unit]
            type=Orcish Archer
            side=1
            id=Loyal_Archer
            unrenamable=yes
            name= _ "Gnork"
            placement=leader
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_INTELLIGENT}
            [/modifications]
            animate=yes
        [/unit]

        [message]
            speaker=Loyal_Assassin
            message=_ "It's a good thing you slaughtered our limited chief, Bazur. Now we stand with you openly."
        [/message]
    [/event]

    [event]
    name=enemies_defeated

        [message]
            speaker=Bazur
            message=_ "Both scumbags are dead. No one else can keep me in this craphole."
        [/message]

        [modify_unit]
            [filter]
                id=Bazur 
            [/filter]
            [modifications]
                {TRAIT_QUICK}
                {TRAIT_STRONG}
            [/modifications]
        [/modify_unit]

        [object] 
            silent=no 
            name= _ "Bazur the Strong"
            image="attacks/sword-orcish.png"
            duration=scenario
            description= _ "Bazur had proven that he was the strongest of the Whitefang chieftains! He gets the <i>strong</i> trait."
            [filter]
                id=Bazur
            [/filter]
        [/object]

        [set_achievement]
            content_for=AD_Achievements
            id=AD_S1_Leaderkills
        [/set_achievement]

        [message]
            speaker=messenger
            message=_ "Well done. Be sure the Queen will greatly appreciate Your military skills."
        [/message]

        [endlevel]
            result=victory
            carryover_add=yes 
            bonus=yes
        [/endlevel]
    [/event]

    [event]
    name=last_breath

        [filter]
            id=messenger
        [/filter]
        [filter_second]
            side=2,3
        [/filter_second]

        [message]
            speaker=second_unit
            message=_ "The messenger is dead! Now Bazur the worm won't go anywhere, and his minions won't get more than we do!"
        [/message]

        [message]
            speaker=Bazur
            message=_ "Damn it! This was my chance to get out of this craphole!"
        [/message]

        [endlevel]
            result=defeat 
        [/endlevel]
    [/event]

    [event]
    name=time over 

        [message]
            speaker=messenger
            message=_ "I can't wait for You forever. If You won't serve the Queen, I'll go to the other clans."
        [/message]

        [sound]
            name=horse-canter.wav
        [/sound]

        {MOVE_UNIT id=messenger 2 27}

        [kill]
            id=messenger
            animate=no 
        [/kill]

        [message]
            speaker=Bazur
            message=_ "Damn it! This was my chance to get out of this craphole!"
        [/message]
    [/event]

    [event]
    name=last_breath

        [filter]
            id=Bazur 
        [/filter]

        [message]
            speaker=Bazur 
            message=_ "Ar, there's nothing worse than dying in this craphole!"
        [/message]
    [/event]
[/scenario]
